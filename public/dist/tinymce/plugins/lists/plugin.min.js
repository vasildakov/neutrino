!function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager");const e=t=>!(t=>null==t)(t),r=(t,e)=>t===e,s=()=>!1;class n{tag;value;static singletonNone=new n(!1);constructor(t,e){this.tag=t,this.value=e}static some(t){return new n(!0,t)}static none(){return n.singletonNone}fold(t,e){return this.tag?e(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?n.some(t(this.value)):n.none()}bind(t){return this.tag?t(this.value):n.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:n.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return e(t)?n.some(t):n.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}const o=Array.prototype.slice,a=(t,e,r)=>{for(let s=0,o=t.length;s<o;s++){const o=t[s];if(e(o,s))return n.some(o);if(r(o,s))break}return n.none()};"function"==typeof Array.from&&Array.from;const i=(t,e,s=r)=>t.exists((t=>s(t,e))),l=(u=/^\s+|\s+$/g,t=>t.replace(u,""));var u;const c=t=>{const e=(t=>{const e=o.call(t,0);return e.reverse(),e})(l(t).split("")),r=((t,e)=>{const r=t.length,s=new Array(r);for(let n=0;n<r;n++){const r=t[n];s[n]=e(r,n)}return s})(e,((t,e)=>{const r=t.toUpperCase().charCodeAt(0)-"A".charCodeAt(0)+1;return Math.pow(26,e)*r}));return s=(t,e)=>t+e,n=0,((t,e)=>{for(let r=0,s=t.length;r<s;r++)e(t[r])})(r,((t,e)=>{n=s(n,t)})),n;var s,n},d=t=>{if(--t<0)return"";{const e=t%26,r=Math.floor(t/26);return d(r)+String.fromCharCode("A".charCodeAt(0)+e)}},g=t=>{const e=parseInt(t.start,10);return i(t.listStyleType,"upper-alpha")?d(e):i(t.listStyleType,"lower-alpha")?d(e).toLowerCase():t.start},m=t=>r=>e(r)&&t.test(r.nodeName),h=m(/^(OL|UL|DL)$/),p=m(/^(TH|TD)$/),y=m(/^(LI|DT|DD)$/),v=(t,e)=>a(t,h,p).exists((t=>t.nodeName===e&&!(t=>/\btox\-/.test(t.className))(t))),f=(t,e)=>{const r=t.selection.getNode();return e({parents:t.dom.getParents(r),element:r}),t.on("NodeChange",e),()=>t.off("NodeChange",e)},b=(t,e)=>{const r=t.dom.getParent(e,"ol,ul,dl");return((t,e)=>null!==e&&!t.dom.isEditable(e))(t,r)||!t.selection.isEditable()},L=t=>e(t)&&"ol"===t.nodeName.toLowerCase(),S=["OL","UL","DL"],C=S.join(","),A=(t,e)=>{const r=e||t.selection.getStart(!0);return t.dom.getParent(r,C,T(t,r))},T=(t,e)=>{const r=t.dom.getParents(e,t.dom.isBlock),n=(o=e=>(e=>e.nodeName.toLowerCase()!==(t=>t.options.get("forced_root_block"))(t))(e)&&N(t.schema,e),a(r,o,s));var o;return n.getOr(t.getBody())},N=(t,e)=>!h(e)&&!y(e)&&(r=>{for(let n=0,o=r.length;n<o;n++)if(s=r[n],t.isValidChild(e.nodeName,s))return!0;var s;return!1})(S),w=(t,e)=>r=>(r.setEnabled(t.selection.isEditable()),f(t,(s=>{r.setActive(v(s.parents,e)),r.setEnabled(!b(t,s.element)&&t.selection.isEditable())}))),O=(t,e)=>r=>f(t,(s=>r.setEnabled(v(s.parents,e)&&!b(t,s.element))));t.add("lists",(t=>((t=>{t.addCommand("mceListProps",(()=>{(t=>{const e=A(t);L(e)&&!b(t,e)&&t.windowManager.open({title:"List Properties",body:{type:"panel",items:[{type:"input",name:"start",label:"Start list at number",inputMode:"numeric"}]},initialData:{start:g({start:t.dom.getAttrib(e,"start","1"),listStyleType:n.from(t.dom.getStyle(e,"list-style-type"))})},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:e=>{(t=>{switch((t=>/^[0-9]+$/.test(t)?2:/^[A-Z]+$/.test(t)?0:/^[a-z]+$/.test(t)?1:t.length>0?4:3)(t)){case 2:return n.some({listStyleType:n.none(),start:t});case 0:return n.some({listStyleType:n.some("upper-alpha"),start:c(t).toString()});case 1:return n.some({listStyleType:n.some("lower-alpha"),start:c(t).toString()});case 3:return n.some({listStyleType:n.none(),start:""});case 4:return n.none()}})(e.getData().start).each((e=>{t.execCommand("mceListUpdate",!1,{attrs:{start:"1"===e.start?"":e.start},styles:{"list-style-type":e.listStyleType.getOr("")}})})),e.close()}})})(t)}))})(t),(t=>{const e=e=>()=>t.execCommand(e);t.hasPlugin("advlist")||(t.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:e("InsertOrderedList"),onSetup:w(t,"OL")}),t.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:e("InsertUnorderedList"),onSetup:w(t,"UL")}))})(t),(t=>{const e={text:"List properties...",icon:"ordered-list",onAction:()=>t.execCommand("mceListProps"),onSetup:O(t,"OL")};t.ui.registry.addMenuItem("listprops",e),t.ui.registry.addContextMenu("lists",{update:e=>{const r=A(t,e);return L(r)?["listprops"]:[]}})})(t),(t=>({backspaceDelete:e=>{t.execCommand("mceListBackspaceDelete",!1,e)}}))(t))))}();
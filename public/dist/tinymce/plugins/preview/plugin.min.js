!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");const t=e=>"function"==typeof e,r=e=>()=>e,n=e=>e,s=r(!1);class o{tag;value;static singletonNone=new o(!1);constructor(e,t){this.tag=e,this.value=t}static some(e){return new o(!0,e)}static none(){return o.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?o.some(e(this.value)):o.none()}bind(e){return this.tag?e(this.value):o.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:o.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw new Error(e??"Called getOrDie on None")}static from(e){return null==e?o.none():o.some(e)}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}Array.prototype.slice;const i=Array.prototype.indexOf,a=(e,t)=>((e,t,r)=>{for(let n=0,s=e.length;n<s;n++){const s=e[n];if(t(s,n))return o.some(s);if(r(s,n))break}return o.none()})(e,t,s);t(Array.from)&&Array.from;const c=Object.keys,u=(e,t)=>{const r=[];return((e,t)=>{const r=c(e);for(let n=0,s=r.length;n<s;n++){const s=r[n];t(e[s],s)}})(e,((e,n)=>{r.push(t(e,n))})),r},l=(e,t,r=0,n)=>{const s=e.indexOf(t,r);return-1!==s&&(!!(e=>void 0===e)(n)||s+t.length<=n)},d=()=>m(0,0),m=(e,t)=>({major:e,minor:t}),h={nu:m,detect:(e,t)=>{const r=String(t).toLowerCase();return 0===e.length?d():((e,t)=>{const r=((e,t)=>{for(let r=0;r<e.length;r++){const n=e[r];if(n.test(t))return n}})(e,t);if(!r)return{major:0,minor:0};const n=e=>Number(t.replace(r,"$"+e));return m(n(1),n(2))})(e,r)},unknown:d},g=(e,t)=>{const r=String(t).toLowerCase();return a(e,(e=>e.search(r)))},v=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,p=e=>t=>l(t,e),f=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>l(e,"edge/")&&l(e,"chrome")&&l(e,"safari")&&l(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,v],search:e=>l(e,"chrome")&&!l(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>l(e,"msie")||l(e,"trident")},{name:"Opera",versionRegexes:[v,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:p("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:p("firefox")},{name:"Safari",versionRegexes:[v,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(l(e,"safari")||l(e,"mobile/"))&&l(e,"applewebkit")}],w=[{name:"Windows",search:p("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>l(e,"iphone")||l(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:p("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:p("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:p("linux"),versionRegexes:[]},{name:"Solaris",search:p("sunos"),versionRegexes:[]},{name:"FreeBSD",search:p("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:p("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],y={browsers:r(f),oses:r(w)},x="Edge",S="Chromium",b="Opera",O="Firefox",A="Safari",C=e=>{const t=e.current,r=e.version,n=e=>()=>t===e;return{current:t,version:r,isEdge:n(x),isChromium:n(S),isIE:n("IE"),isOpera:n(b),isFirefox:n(O),isSafari:n(A)}},R=()=>C({current:void 0,version:h.unknown()}),k=C,D=(r(x),r(S),r("IE"),r(b),r(O),r(A),"Windows"),E="Android",I="Linux",T="macOS",L="Solaris",P="FreeBSD",$="ChromeOS",_=e=>{const t=e.current,r=e.version,n=e=>()=>t===e;return{current:t,version:r,isWindows:n(D),isiOS:n("iOS"),isAndroid:n(E),isMacOS:n(T),isLinux:n(I),isSolaris:n(L),isFreeBSD:n(P),isChromeOS:n($)}},B=()=>_({current:void 0,version:h.unknown()}),N=_,F=(r(D),r("iOS"),r(E),r(I),r(T),r(L),r(P),r($),(e,t,n)=>{const s=y.browsers(),i=y.oses(),c=t.bind((e=>((e,t)=>((e,t)=>{for(let r=0;r<e.length;r++){const n=t(e[r]);if(n.isSome())return n}return o.none()})(t.brands,(t=>{const r=t.brand.toLowerCase();return a(e,(e=>r===e.brand?.toLowerCase())).map((e=>({current:e.name,version:h.nu(parseInt(t.version,10),0)})))})))(s,e))).orThunk((()=>((e,t)=>g(e,t).map((e=>{const r=h.detect(e.versionRegexes,t);return{current:e.name,version:r}})))(s,e))).fold(R,k),u=((e,t)=>g(e,t).map((e=>{const r=h.detect(e.versionRegexes,t);return{current:e.name,version:r}})))(i,e).fold(B,N),l=((e,t,n,s)=>{const o=e.isiOS()&&!0===/ipad/i.test(n),i=e.isiOS()&&!o,a=e.isiOS()||e.isAndroid(),c=a||s("(pointer:coarse)"),u=o||!i&&a&&s("(min-device-width:768px)"),l=i||a&&!u,d=t.isSafari()&&e.isiOS()&&!1===/safari/i.test(n),m=!l&&!u&&!d;return{isiPad:r(o),isiPhone:r(i),isTablet:r(u),isPhone:r(l),isTouch:r(c),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:r(d),isDesktop:r(m)}})(u,c,e,n);return{browser:c,os:u,deviceType:l}}),M=e=>window.matchMedia(e).matches;let j=(e=>{let t,r=!1;return(...n)=>(r||(r=!0,t=e.apply(null,n)),t)})((()=>F(window.navigator.userAgent,o.from(window.navigator.userAgentData),M)));const U=()=>j();var W=tinymce.util.Tools.resolve("tinymce.dom.ScriptLoader"),K=tinymce.util.Tools.resolve("tinymce.util.Tools");const V=e=>t=>t.options.get(e),z=V("content_style"),Y=V("content_css_cors"),q=V("body_class"),G=V("body_id"),H=e=>{var r;return((e,t)=>{const r=e.length,n=new Array(r);for(let s=0;s<r;s++){const r=e[s];n[s]=t(r)}return n})(((e,r)=>{const n=[],s=t(r)?e=>((e,t)=>{for(let r=0,n=e.length;r<n;r++)if(t(e[r]))return!0;return!1})(n,(t=>r(t,e))):e=>((e,t)=>((e,t)=>i.call(e,t))(e,t)>-1)(n,e);for(let t=0,r=e.length;t<r;t++){const r=e[t];s(r)||n.push(r)}return n})((r=e.schema.getComponentUrls(),u(r,n))),(t=>{const r=u(W.ScriptLoader.getScriptAttributes(t),((t,r)=>` ${e.dom.encode(r)}="${e.dom.encode(t)}"`));return`<script src="${e.dom.encode(t)}"${r.join("")}><\/script>`})).join("")};e.add("preview",(e=>{(e=>{e.addCommand("mcePreview",(()=>{(e=>{const t=(e=>{let t="";const r=e.dom.encode,n=z(e)??"";t+=`<base href="${r(e.documentBaseURI.getURI())}">`;const s=Y(e)?' crossorigin="anonymous"':"";K.each(e.contentCSS,(n=>{t+='<link type="text/css" rel="stylesheet" href="'+r(e.documentBaseURI.toAbsolute(n))+'"'+s+">"})),n&&(t+='<style type="text/css">'+n+"</style>"),t+=H(e);const o=G(e),i=q(e),a=e.getBody().dir,c=a?' dir="'+r(a)+'"':"";return"<!DOCTYPE html><html><head>"+t+'</head><body id="'+r(o)+'" class="mce-content-body '+r(i)+'"'+c+">"+e.getContent()+(()=>{const e=U().os.isMacOS()||U().os.isiOS();return`<script>(${(e=>{document.addEventListener("click",(t=>{for(let r=t.target;r;r=r.parentNode)if("A"===r.nodeName){const n=r.getAttribute("href");if(n&&n.startsWith("#")){t.preventDefault();const e=document.getElementById(n.substring(1));return void(e&&e.scrollIntoView({behavior:"smooth"}))}(e?t.metaKey:t.ctrlKey&&!t.altKey)||t.preventDefault()}}),!1)}).toString()})(${e})<\/script>`})()+"</body></html>"})(e);e.windowManager.open({title:"Preview",size:"large",body:{type:"panel",items:[{name:"preview",type:"iframe",sandboxed:!0,transparent:!1}]},buttons:[{type:"cancel",name:"close",text:"Close",primary:!0}],initialData:{preview:t}}).focus("close")})(e)}))})(e),(e=>{const t=()=>e.execCommand("mcePreview");e.ui.registry.addButton("preview",{icon:"preview",tooltip:"Preview",onAction:t,context:"any"}),e.ui.registry.addMenuItem("preview",{icon:"preview",text:"Preview",onAction:t,context:"any"})})(e)}))}();